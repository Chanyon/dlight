import {View} from "@dlightjs/dlight";
import {Transition} from "../../../packages/@dlightjs/components/src/Animation/index";


class OK {
    id
    text
    constructor(text) {
        this.id = Math.random().toString(20)
        this.text= text
    }
}
function ok(text) {
    return new OK(text)
}
export class TransitionTest extends View {
    @State list = [
        ok("第一个"),
        ok("ererer"),
        ok("333333"),
        ok("四个四个个"),
        ok("义务！！"),
    ]
    remove() {
        this.list.splice(Math.floor(Math.random()*(this.list.length-1)), 1)
        this.list = [...this.list]
    }
    add() {
        this.list.splice(Math.floor(Math.random()*(this.list.length-1)), 0, ok(`---${this.list.length}`))
        // this.list.unshift(ok(`---${this.list.length}`))
        this.list = [...this.list]
    }
    shuffle() {
        let newList = this.list
        while(JSON.stringify(newList) === JSON.stringify(this.list)) {
            newList = this.list
                .map(value => ({ value, sort: Math.random() }))
                .sort((a, b) => a.sort - b.sort)
                .map(({ value }) => value)
        }
        this.list = [...newList]
    }
    @State length = 100
    Body() {
        button("shuffle")
            .onclick(() => {
                this.shuffle()
            })
        button("remove")
            .onclick(() => {
                this.remove()
            })
        button("add")
            .onclick(() => {
                this.add()
            })
        button("+")
            .onclick(() => {
                this.length += 50
            })
        button("-")
            .onclick(() => {
                this.length -= 50
            })
        Transition({
            appearWith: {opacity:0, transform:"translate(300px, 300px)", "background-color":"blue"},
            disappearWith: {opacity:0, transform:"translateX(100px)", "background-color":"yellow", transitionDelay:"1s"},
        }) {
            For (let ok of this.list)[ok.id] {
                div(ok.text)
                    ._marginTop("10px")
                    ._backgroundColor("red")
                    ._width(`${this.length}px`)
            }
        }
    }

}