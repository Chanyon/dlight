(function(a,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("@dlightjs/dlight")):typeof define=="function"&&define.amd?define(["exports","@dlightjs/dlight"],h):(a=typeof globalThis<"u"?globalThis:a||self,h(a.component={},a._$))})(this,function(a,h){"use strict";var S=Object.defineProperty;var x=(a,h,c)=>h in a?S(a,h,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[h]=c;var e=(a,h,c)=>(x(a,typeof h!="symbol"?h+"":h,c),c);function c(s){const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const t in s)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(s,t);Object.defineProperty(d,t,n.get?n:{enumerable:!0,get:()=>s[t]})}}return d.default=s,Object.freeze(d)}const p=c(h);class w extends h.View{constructor(){super(...arguments);e(this,"_$tag","Spacer");e(this,"Body",()=>[new p.HtmlNode("div")])}}class f extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{margin:["alignment"]});e(this,"_$deps",{spacing:new Map,alignment:new Map,width:new Map,height:new Map,margin:new Map});e(this,"_$tag","HStack");e(this,"_$$spacing","_$prop");e(this,"spacing",10);e(this,"_$$alignment","_$prop");e(this,"alignment","top");e(this,"_$$width","_$prop");e(this,"width","100%");e(this,"_$$height","_$prop");e(this,"height","max-content");e(this,"margin",()=>function(){switch(this.alignment){case"top":return"0 0 auto 0";case"bottom":return"auto 0 0 0";case"center":return"auto 0";default:return""}}.call(this));e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",()=>`${this.spacing}px`,this,["spacing"]),t._$addProp("_display","flex"),t._$addProp("_flexDirection","row"),t._$addNodes((()=>{const n=new p.ForNode;return n._$addNodess(Array.from(this._$children.map(i=>i())).map(i=>(()=>{const r=new p.IfNode;return r._$addCond(()=>i._$tag==="Spacer",()=>{const o=new p.ExpressionNode(i);return o._$addProp("_flexGrow",1),[o]}),r._$addCond(()=>!0,()=>{const o=new p.ExpressionNode(i);return o._$addProp("_flexShrink",0),o._$addProp("_margin",()=>this.margin,this,["margin"],!0),[o]}),[r]})())),[n]})()),[t]})}}class v extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{margin:["alignment"]});e(this,"_$deps",{spacing:new Map,alignment:new Map,width:new Map,height:new Map,margin:new Map});e(this,"_$tag","VStack");e(this,"_$$spacing","_$prop");e(this,"spacing",10);e(this,"_$$alignment","_$prop");e(this,"alignment","top");e(this,"_$$width","_$prop");e(this,"width","max-content");e(this,"_$$height","_$prop");e(this,"height","100%");e(this,"margin",()=>function(){switch(this.alignment){case"top":return"0 auto 0 0";case"bottom":return"0 0 0 auto";case"center":return"0 auto";default:return""}}.call(this));e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",()=>`${this.spacing}px`,this,["spacing"]),t._$addProp("_display","flex"),t._$addProp("_flexDirection","column"),t._$addNodes((()=>{const n=new p.ForNode;return n._$addNodess(Array.from(this._$children.map(i=>i())).map(i=>(()=>{const r=new p.IfNode;return r._$addCond(()=>i._$tag==="Spacer",()=>{const o=new p.ExpressionNode(i);return o._$addProp("_flexGrow",1),[o]}),r._$addCond(()=>!0,()=>{const o=new p.ExpressionNode(i);return o._$addProp("_flexShrink",0),o._$addProp("_margin",()=>this.margin,this,["margin"],!0),[o]}),[r]})())),[n]})()),[t]})}}class y extends h.View{constructor(){super(...arguments);e(this,"_$deps",{hAlignment:new Map,vAlignment:new Map,width:new Map,height:new Map});e(this,"_$tag","ZStack");e(this,"_$$hAlignment","_$prop");e(this,"hAlignment","center");e(this,"_$$vAlignment","_$prop");e(this,"vAlignment","center");e(this,"_$$width","_$prop");e(this,"width","max-content");e(this,"_$$height","_$prop");e(this,"height","max-content");e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",`${this.spacing}px`),t._$addProp("_display","grid"),t._$addProp("_alignItems",()=>({top:"flex-start",center:"center",bottom:"flex-end"})[this.vAlignment],this,["vAlignment"]),t._$addProp("_justifyItems",()=>({leading:"left",center:"center",tailing:"right"})[this.hAlignment],this,["hAlignment"]),t._$addNodes((()=>{const n=new p.ForNode;return n._$addNodess(Array.from(this._$children.map(i=>i())).map(i=>(()=>{const r=new p.ExpressionNode(i);return r._$addProp("_position","relative"),r._$addProp("_gridArea","1 / 1/ 1 / 1"),[r]})())),[n]})()),[t]})}}function l(){return location.hash.slice(2)}function u(){return location.pathname.slice(1)}function g(s,d){let t;if(s[0]==="/")t=s;else{s[0]!=="."&&(s="./"+s);const n=s.split("/"),i=d.split("/").filter(o=>o);let r=0;for(let o of n){if(![".",".."].includes(o))break;o===".."&&(i.length===0&&console.warn(`no ../ in ${s}`),i.pop()),r++}t="/"+[...i,...n.slice(r)].join("/")}return t}class m{constructor(){e(this,"mode","hash");e(this,"baseUrl","")}hashTo(d){window.location.href="#"+g(d,this.baseUrl)}historyTo(d){window.history.pushState({},"",g(d,this.baseUrl))}to(d){if(this.mode==="hash"){this.hashTo(d);return}this.historyTo(d)}}class P extends h.View{constructor(){super(...arguments);e(this,"_$deps",{_$content:new Map});e(this,"_$tag","Route");e(this,"_$$_$content","_$prop");e(this,"_$content","_$default");e(this,"Body",()=>{var n;return[new p.ExpressionNode((n=this._$children)==null?void 0:n.map(i=>i()))]})}}const $=history.pushState;let _=[];class N extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{currUrl:["mode"],showedRoute:["currUrl"]});e(this,"_$deps",{mode:new Map,navigator:new Map,currUrl:new Map,showedRoute:new Map});e(this,"_$tag","RouterSpace");e(this,"_$$mode","_$prop");e(this,"mode","history");e(this,"_$$navigator");e(this,"_$$currUrl",()=>this.mode==="hash"?l():u());e(this,"baseUrl","");e(this,"prevPathCondition","");e(this,"prevRoutes",[]);e(this,"showedRoute",()=>function(){const t=this.prevPathCondition;this.prevPathCondition="";let n=[];for(let i of this._$children){const r=i();if(r._$tag!=="Route"){n.push(r);continue}if(this.currUrl.startsWith(this.baseUrl+r._$content)||r._$content==="_$default"){if(r._$content===t)return this.prevPathCondition=t,this.prevRoutes;n.push(r),this.prevPathCondition=r._$content;break}}return this.prevRoutes=n,n}.call(this));e(this,"historyChangeListen",()=>{this.currUrl=u()});e(this,"hashChangeListen",()=>{this.currUrl=l()});e(this,"Body",()=>{const t=new p.EnvNode;return t._$addNodes((()=>[new p.ExpressionNode(()=>this.showedRoute,this,["showedRoute"])])()),t._$addProp("RouteParam",()=>({path:this.currUrl,navigator:this.navigator}),this,["currUrl","navigator"],!1),[t]})}get navigator(){return this._$$navigator}set navigator(t){this._$$navigator!==t&&(this._$$navigator=t,this._$runDeps("navigator"))}get currUrl(){return this._$$currUrl}set currUrl(t){this._$$currUrl!==t&&(this._$$currUrl=t,this._$runDeps("currUrl"))}didMount(){if(this.mode==="hash"){addEventListener("load",this.hashChangeListen),addEventListener("hashchange",this.hashChangeListen);return}addEventListener("load",this.historyChangeListen),addEventListener("popstate",this.historyChangeListen),_.push(this.historyChangeListen),history.pushState=new Proxy($,{apply:(t,n,i)=>{const r=t.apply(n,i);for(let o of _)o();return r}})}willUnmount(){if(this.mode==="hash"){removeEventListener("load",this.hashChangeListen),removeEventListener("hashchange",this.hashChangeListen);return}removeEventListener("load",this.historyChangeListen),removeEventListener("popstate",this.historyChangeListen),_=_.filter(t=>t!==this.historyChangeListen),_.length>0?history.pushState=new Proxy($,{apply:(t,n,i)=>{const r=t.apply(n,i);for(let o of _)o();return r}}):history.pushState=$}AfterConstruct(){let t=this._$parentNode;for(;t;)t._$tag==="Route"&&(this.baseUrl=t._$content+"/"+this.baseUrl),t=t._$parentNode}Preset(){const t=new m;t.mode=this.mode,t.baseUrl=this.baseUrl,this.navigator=t}}a.HStack=f,a.Navigator=m,a.Route=P,a.RouterSpace=N,a.Spacer=w,a.VStack=v,a.ZStack=y,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
