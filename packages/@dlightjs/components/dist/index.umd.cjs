(function(a,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("@dlightjs/dlight")):typeof define=="function"&&define.amd?define(["exports","@dlightjs/dlight"],h):(a=typeof globalThis<"u"?globalThis:a||self,h(a.component={},a._$))})(this,function(a,h){"use strict";var C=Object.defineProperty;var b=(a,h,_)=>h in a?C(a,h,{enumerable:!0,configurable:!0,writable:!0,value:_}):a[h]=_;var e=(a,h,_)=>(b(a,typeof h!="symbol"?h+"":h,_),_);function _(o){const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const t in o)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(o,t);Object.defineProperty(d,t,r.get?r:{enumerable:!0,get:()=>o[t]})}}return d.default=o,Object.freeze(d)}const p=_(h);class v extends h.View{constructor(){super(...arguments);e(this,"_$tag","Spacer");e(this,"Body",()=>[new p.HtmlNode("div")])}}class y extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{margin:["alignment"]});e(this,"_$deps",{spacing:new Map,alignment:new Map,width:new Map,height:new Map,margin:new Map});e(this,"_$tag","HStack");e(this,"_$$spacing","_$prop");e(this,"spacing",10);e(this,"_$$alignment","_$prop");e(this,"alignment","top");e(this,"_$$width","_$prop");e(this,"width","100%");e(this,"_$$height","_$prop");e(this,"height","max-content");e(this,"margin",()=>function(){switch(this.alignment){case"top":return"0 0 auto 0";case"bottom":return"auto 0 0 0";case"center":return"auto 0";default:return""}}.call(this));e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",()=>`${this.spacing}px`,this,["spacing"]),t._$addProp("_display","flex"),t._$addProp("_flexDirection","row"),t._$addNodes((()=>{const r=new p.ForNode;return r._$addNodess(Array.from(this._$children.map(n=>n())).map(n=>(()=>{const s=new p.IfNode;return s._$addCond(()=>n._$tag==="Spacer",()=>{const i=new p.ExpressionNode(n);return i._$addProp("_flexGrow",1),[i]}),s._$addCond(()=>!0,()=>{const i=new p.ExpressionNode(n);return i._$addProp("_flexShrink",0),i._$addProp("_margin",()=>this.margin,this,["margin"],!0),[i]}),[s]})())),[r]})()),[t]})}}class P extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{margin:["alignment"]});e(this,"_$deps",{spacing:new Map,alignment:new Map,width:new Map,height:new Map,margin:new Map});e(this,"_$tag","VStack");e(this,"_$$spacing","_$prop");e(this,"spacing",10);e(this,"_$$alignment","_$prop");e(this,"alignment","top");e(this,"_$$width","_$prop");e(this,"width","max-content");e(this,"_$$height","_$prop");e(this,"height","100%");e(this,"margin",()=>function(){switch(this.alignment){case"top":return"0 auto 0 0";case"bottom":return"0 0 0 auto";case"center":return"0 auto";default:return""}}.call(this));e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",()=>`${this.spacing}px`,this,["spacing"]),t._$addProp("_display","flex"),t._$addProp("_flexDirection","column"),t._$addNodes((()=>{const r=new p.ForNode;return r._$addNodess(Array.from(this._$children.map(n=>n())).map(n=>(()=>{const s=new p.IfNode;return s._$addCond(()=>n._$tag==="Spacer",()=>{const i=new p.ExpressionNode(n);return i._$addProp("_flexGrow",1),[i]}),s._$addCond(()=>!0,()=>{const i=new p.ExpressionNode(n);return i._$addProp("_flexShrink",0),i._$addProp("_margin",()=>this.margin,this,["margin"],!0),[i]}),[s]})())),[r]})()),[t]})}}class x extends h.View{constructor(){super(...arguments);e(this,"_$deps",{hAlignment:new Map,vAlignment:new Map,width:new Map,height:new Map});e(this,"_$tag","ZStack");e(this,"_$$hAlignment","_$prop");e(this,"hAlignment","center");e(this,"_$$vAlignment","_$prop");e(this,"vAlignment","center");e(this,"_$$width","_$prop");e(this,"width","max-content");e(this,"_$$height","_$prop");e(this,"height","max-content");e(this,"Body",()=>{const t=new p.HtmlNode("div");return t._$addProp("_height",()=>this.height,this,["height"]),t._$addProp("_width",()=>this.width,this,["width"]),t._$addProp("_columnGap",`${this.spacing}px`),t._$addProp("_display","grid"),t._$addProp("_alignItems",()=>({top:"flex-start",center:"center",bottom:"flex-end"})[this.vAlignment],this,["vAlignment"]),t._$addProp("_justifyItems",()=>({leading:"left",center:"center",tailing:"right"})[this.hAlignment],this,["hAlignment"]),t._$addNodes((()=>{const r=new p.ForNode;return r._$addNodess(Array.from(this._$children.map(n=>n())).map(n=>(()=>{const s=new p.ExpressionNode(n);return s._$addProp("_position","relative"),s._$addProp("_gridArea","1 / 1/ 1 / 1"),[s]})())),[r]})()),[t]})}}function g(){return location.hash.slice(2)}function m(){return location.pathname.slice(1)}function w(o,d){let t;if(o[0]==="/")t=o;else{o[0]!=="."&&(o="./"+o);const r=o.split("/"),n=d.split("/").filter(i=>i);let s=0;for(let i of r){if(![".",".."].includes(i))break;i===".."&&(n.length===0&&console.warn(`no ../ in ${o}`),n.pop()),s++}t="/"+[...n,...r.slice(s)].join("/")}return t}class f{constructor(){e(this,"mode","hash");e(this,"baseUrl","")}hashTo(d){window.location.href="#"+w(d,this.baseUrl)}historyTo(d){window.history.pushState({},"",w(d,this.baseUrl))}to(d){if(this.mode==="hash"){this.hashTo(d);return}this.historyTo(d)}}class N extends h.View{constructor(){super(...arguments);e(this,"_$deps",{_$content:new Map});e(this,"_$tag","Route");e(this,"_$$_$content","_$prop");e(this,"_$content"," none");e(this,"Body",()=>{var r;return[new p.ExpressionNode((r=this._$children)==null?void 0:r.map(n=>n()))]})}}const l=history.pushState;let $=[];class S extends h.View{constructor(){super(...arguments);e(this,"_$derivedPairs",{currUrl:["mode"],showedRoute:["currUrl"]});e(this,"_$deps",{mode:new Map,navigator:new Map,currUrl:new Map,showedRoute:new Map});e(this,"_$tag","RouterSpace");e(this,"_$$mode","_$prop");e(this,"mode","history");e(this,"_$$navigator");e(this,"_$$currUrl",()=>this.mode==="hash"?g():m());e(this,"baseUrl","");e(this,"prevPathCondition"," none");e(this,"prevRoutes",[]);e(this,"showedRoute",()=>function(){const t=this.prevPathCondition;this.prevPathCondition=" none";const r=this.currUrl.replace(new RegExp(`^${this.baseUrl}`),"");let n=[];for(let s of this._$children){const i=s();if(i._$tag!=="Route"){n.push(i);continue}let c=i._$content,u=!1;if(typeof i._$content=="string"){c=c.replace(/^(\.\/)+/,"");const U=c==="."&&r==="",M=(r+"/").startsWith(c+"/");u=U||M||c===" none"}else c instanceof RegExp&&(u=c.test(r));if(u){if(c===t)return this.prevPathCondition=t,this.prevRoutes;n.push(i),this.prevPathCondition=c;break}}return this.prevRoutes=n,n}.call(this));e(this,"historyChangeListen",()=>{this.currUrl=m()});e(this,"hashChangeListen",()=>{this.currUrl=g()});e(this,"Body",()=>{const t=new p.EnvNode;return t._$addNodes((()=>[new p.ExpressionNode(()=>this.showedRoute,this,["showedRoute"])])()),t._$addProp("RouteParam",()=>({path:this.currUrl,navigator:this.navigator}),this,["currUrl","navigator"],!1),[t]})}get navigator(){return this._$$navigator}set navigator(t){this._$$navigator!==t&&(this._$$navigator=t,this._$runDeps("navigator"))}get currUrl(){return this._$$currUrl}set currUrl(t){this._$$currUrl!==t&&(this._$$currUrl=t,this._$runDeps("currUrl"))}didMount(){if(this.mode==="hash"){addEventListener("load",this.hashChangeListen),addEventListener("hashchange",this.hashChangeListen);return}addEventListener("load",this.historyChangeListen),addEventListener("popstate",this.historyChangeListen),$.push(this.historyChangeListen),history.pushState=new Proxy(l,{apply:(t,r,n)=>{const s=t.apply(r,n);for(let i of $)i();return s}})}willUnmount(){if(this.mode==="hash"){removeEventListener("load",this.hashChangeListen),removeEventListener("hashchange",this.hashChangeListen);return}removeEventListener("load",this.historyChangeListen),removeEventListener("popstate",this.historyChangeListen),$=$.filter(t=>t!==this.historyChangeListen),$.length>0?history.pushState=new Proxy(l,{apply:(t,r,n)=>{const s=t.apply(r,n);for(let i of $)i();return s}}):history.pushState=l}AfterConstruct(){let t=this._$parentNode;for(;t;)t._$tag==="Route"&&(this.baseUrl=t._$content+"/"+this.baseUrl),t=t._$parentNode}Preset(){const t=new f;t.mode=this.mode,t.baseUrl=this.baseUrl,this.navigator=t}}a.HStack=y,a.Navigator=f,a.Route=N,a.RouterSpace=S,a.Spacer=v,a.VStack=P,a.ZStack=x,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
